[build]
  command = "turbo run build --filter @repo/webapp"
  publish = "apps/webapp/.next"

[build.environment]
  # Skip secrets scanning for these intentionally public Next.js env vars
  # NEXT_PUBLIC_* variables are designed to be exposed to the client
  SECRETS_SCAN_OMIT_KEYS = "NEXT_PUBLIC_SUPABASE_URL,NEXT_PUBLIC_SUPABASE_ANON_KEY"

# Proxy /docs/* to the docs site (hosted separately on Netlify)
[[redirects]]
  from = "/docs/*"
  to = "https://matchdocs.netlify.app/docs/:splat"
  status = 200
  force = true

# Proxy static assets for docs site
[[redirects]]
  from = "/_astro/*"
  to = "https://matchdocs.netlify.app/_astro/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/pagefind/*"
  to = "https://matchdocs.netlify.app/pagefind/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/favicon.svg"
  to = "https://matchdocs.netlify.app/favicon.svg"
  status = 200
  force = true

